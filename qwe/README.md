# 企业数字化转型指数查询系统

一个基于Streamlit框架的Web应用，用于查询和可视化企业数字化转型指数数据。

## 功能特点

- 📊 **数据可视化**：使用交互式折线图展示企业历年数字化转型指数趋势
- 🔍 **智能查询**：支持按股票代码和年份查询特定企业的数据
- 📈 **统计分析**：提供企业数字化转型指数的统计信息（平均值、最高值、最低值等）
- 🎨 **友好界面**：现代化的用户界面设计，操作简单直观
- 🛠️ **自动检测**：智能识别Excel文件中的关键列（股票代码、年份、指数）
- ❗ **错误处理**：完善的错误提示和用户指导

## 安装依赖

确保您的系统已安装Python 3.8+，然后执行以下命令安装必要的依赖包：

```bash
pip install pandas streamlit plotly openpyxl
```

## 使用方法

1. **准备数据**：将您的Excel数据文件命名为`数字化转型指数合并数据.xlsx`，并确保与应用程序在同一目录下。

2. **启动应用**：在命令行中执行以下命令：

```bash
streamlit run digital_transformation_app.py
```

3. **访问应用**：应用启动后，将自动在浏览器中打开。如果没有自动打开，请访问命令行中显示的URL（通常是`http://localhost:8501`）。

4. **查询数据**：
   - 在左侧边栏查看使用说明
   - 选择股票代码和年份
   - 查看查询结果和历年趋势图

## 数据格式要求

您的Excel文件应包含以下关键信息：

- **股票代码**：企业的股票代码（如：600000、AAPL等）
- **年份**：数据对应的年份（如：2020、2021等）
- **数字化转型指数**：企业的数字化转型指数值（数值类型）

应用会自动检测这些列，支持多种常见的列名格式。

## 应用界面

### 1. 数据概览
显示数据的基本信息，包括数据规模、字段名称和前几行数据。

### 2. 自动列检测
智能识别Excel文件中的股票代码列、年份列和数字化转型指数列。

### 3. 查询条件
选择股票代码和年份进行数据查询。

### 4. 查询结果
显示特定股票和年份的详细数据，包括数字化转型指数值。

### 5. 历年趋势图
使用交互式折线图展示企业历年数字化转型指数的变化趋势。

### 6. 统计信息
提供企业数字化转型指数的统计数据，如平均指数、最高指数、最低指数等。

## 注意事项

1. 确保Excel文件编码正确，避免中文乱码
2. 数据中不要包含合并单元格
3. 年份建议使用4位数字格式（如：2023）
4. 数字化转型指数应为数值类型
5. 如果自动列检测失败，可以尝试手动映射列

## 技术栈

- **Streamlit**：Web应用框架
- **Pandas**：数据处理库
- **Plotly**：数据可视化库
- **OpenPyXL**：Excel文件读取库

## 故障排除

### 文件未找到
确保Excel文件`数字化转型指数合并数据.xlsx`与应用程序在同一目录下。

### 列检测失败
检查Excel文件是否包含股票代码、年份和数字化转型指数列，或尝试使用手动列映射功能。

### 依赖安装失败
确保使用的是最新版本的pip，并尝试使用以下命令升级pip：

```bash
pip install --upgrade pip
```

然后重新安装依赖包。

## 许可证

MIT License
